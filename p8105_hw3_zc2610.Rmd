---
title: "p8105_hw3_zc2610"
author: "Zuoqiao Cui"
date: "2022-10-07"
output: github_document
editor_options: 
  chunk_output_type: inline
---
```{r}
library(tidyverse)
```
## Problem 2
Import data
```{r}
acc_df = read.csv("./data/accel_data.csv") %>% 
  janitor::clean_names()
```
Combine all activity columns
```{r}
acc_df = acc_df %>% 
  pivot_longer(
    activity_1:activity_1440,
    names_to = "activity_minute",
    values_to = "counts",
    names_prefix = "activity_"
  )
```
Create a weekday vs weekend variable
```{r}
acc_df = acc_df %>% 
  mutate(
    weekday_or_weekend = case_when(
      day == "Monday" ~ "weekday",
      day == "Tuesday" ~ "weekday",
      day == "Wednesday" ~ "weekday",
      day == "Thursday" ~ "weekday",
      day == "Friday" ~ "weekday",
      day == "Saturday" ~ "weekend",
      day == "Sunday" ~ "weekend",
      TRUE     ~ ""
    )
  ) 
```

```{r}
colnames(acc_df)
nrow(acc_df)
ncol(acc_df)
```

Description

1. The resulting dataset contains following variables: `r colnames(acc_df)`

2. There are totally `r nrow(acc_df)` observations and `r ncol(acc_df)` variables in the resulting dataset

create a variable that sums up counts of activities in each day and show in a table
```{r}
acc_df %>% 
  group_by(week,day_id,day) %>% 
  summarise(
    total_activity = sum(`counts`)
  ) %>% 
  knitr::kable(digits = 1)
```

single panel plot that shows the 24-hour activity time courses for each day

```{r}
acc_df %>% 
   ggplot(aes(x = activity_minute,y = counts,color = day)) +
   geom_point() +
   labs(
    title = "24-Hour Activity Time Courses For Each Day",
    x = "Time(minute)",
    y = "Activity Counts"
  )
```

## Problem 3
Load data
```{r}
library(p8105.datasets)
data("ny_noaa")
```
Tidy data
1.Separate date into year, month, day
```{r}
ny_noaa = ny_noaa %>% 
  janitor::clean_names() %>% 
    separate(date,into = c("year","month","day"),sep = "-")
```
2. To ensure observations for temperature, precipitation, and snowfall are given in reasonable units
since the observation for precipitation uses tenths of mm as its unit, we can change it to mm unit. The unit of temperature also needs to be changed from tenths of degrees to degrees

```{r}
ny_noaa = ny_noaa %>% 
  mutate(
    prcp = prcp/10,
    tmax = as.numeric(tmax)/10,
    tmin = as.numeric(tmin)/10
  )
ny_noaa
```
3. Find the most commonly observed values for snowfall
```{r}
total_num_of_snowfall = (nrow(ny_noaa))
num_of_na_snowfall = sum(is.na(ny_noaa$snow))
percentage_of_na = num_of_na_snowfall/total_num_of_snowfall
num_of_zero_snowfall = nrow(filter(ny_noaa,snow == 0))
percentage_of_zero = num_of_zero_snowfall/total_num_of_snowfall
```
Answer:

The percentage of NA value in snowfall column is `r sum(is.na(ny_noaa$snow))/(nrow(ny_noaa))` and the percentage of 0 value in snowfall column is `r nrow(filter(ny_noaa,snow == 0))/(nrow(ny_noaa))`.

Since the percentage of 0 value in snowfall column is `r nrow(filter(ny_noaa,snow == 0))/(nrow(ny_noaa))` > 0.5, which means more than half of the value for snowfall is 0. Therefore, the most commonly observed values for snowfall is 0.

Change month number to month name
```{r}
ny_noaa = ny_noaa %>% 
  mutate(
     month = recode(month, "01" = "January",
                  "02" = "February",
                  "03" = "March",
                  "04" = "April",
                  "05" = "May",
                  "06" = "June",
                  "07" = "July",
                  "08" = "Augest",
                  "09" = "September",
                  "10" = "October",
                  "11" = "November", 
                  "12" = "December"
                  )
     )
```

(ii) Make a plot show the distribution of snowfall values greater than 0 and less than 100 separated by year
```{r}
ny_noaa %>% 
  group_by(year) %>% 
  filter(snow > 0 & snow < 100) %>% 
    summarize(
      snowfall_value = sum(snow, na.rm = TRUE)
      ) %>% 
  ggplot(aes(x = year, y = snowfall_value)) + 
  geom_point() +
  labs(
    title = "Snowfall Value Plot",
    x = "Year",
    y = "Snowfall Value",
    caption = "Data from NY NOAA"
  ) +
   theme(plot.title = element_text(hjust = 0.5)) 
```

















